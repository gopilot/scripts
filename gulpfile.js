function runServer(t){require("http").createServer(function(t,s){t.addListener("end",function(){file.serve(t,s)}).resume()}).listen(t||8e3)}var gulp=require("gulp"),stylus=require("gulp-stylus"),jade=require("gulp-jade"),when=require("when"),jsyaml=require("js-yaml"),fs=require("fs"),deploy=require("gulp-gh-pages"),static=require("node-static"),file=new static.Server("./out");gulp.task("deploy",["stylus","html","static","scripts"],function(){var t="https://github.com/gopilot/philly.git";return gulp.src("./out/**/*").pipe(deploy(t))}),gulp.task("stylus",function(){return gulp.src("./css/[!_]*.styl").pipe(stylus({use:["nib"]})).pipe(gulp.dest("./out/css"))}),gulp.task("html",function(){var t=jsyaml.load(fs.readFileSync("./info.yaml","utf8"));return gulp.src("./[!_]*.jade").pipe(jade({locals:t})).pipe(gulp.dest("./out"))}),gulp.task("default",["stylus","html","scripts","static"]),gulp.task("static",function(){return gulp.src("./static/**").pipe(gulp.dest("./out"))}),gulp.task("scripts",function(){return gulp.src("./scripts/**").pipe(gulp.dest("./out/scripts"))}),gulp.task("watch",function(){runServer(),gulp.watch("./static/**",["static"]),gulp.watch("./css/*.styl",["stylus"]),gulp.watch("./scripts/**/*.js",["scripts"]),gulp.watch(["./*.jade","./components/*.jade","./info.yaml"],["html"])});